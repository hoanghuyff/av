repeat wait() until game:IsLoaded() and game.Players.LocalPlayer

-- Vòng lặp chính
task.spawn(function()
    while true do
        local newLevel = getLevel()

        if newLevel then
            if currentLevel == nil then
                currentLevel = newLevel
            elseif newLevel > currentLevel then
                currentLevel = newLevel
                lastUpdateTime = os.time()
            elseif os.time() - lastUpdateTime >= maxIdleTime then
                hopToServer()
            end

            -- Kiểm tra điều kiện đạt Level 2600 và sử dụng God Human
            if newLevel >= 2600 and checkFightingStyleByTool() then
                print("Level đạt 2600 và sử dụng God Human, thoát game trong 120 giây...")
                for countdown = 120, 1, -1 do
                    print("Thoát game sau " .. countdown .. " giây...")
                    task.wait(1)
                end
                voluntaryKick = true
                game:Shutdown()
                break
            end
        end

        -- Kiểm tra nếu có người chơi gần
        if isNearPlayer() then
            task.wait(math.random(60, 120))
            hopToServer()
            break
        end

        -- Kiểm tra trạng thái kẹt
        checkStuck()
        task.wait(checkDelay)
    end
end)

-- Gửi tin nhắn quảng cáo định kỳ
task.spawn(function()
    while true do
        wait(300)
        local message = "buy nick at sokiimarket ⊙ com"
        local chatEvent = game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest
        chatEvent:FireServer(message, "All")
    end
end)

-- Cài đặt cấu hình
script_key = "lVWMqNUwGXRHMmyrQYfkBdsMiQKazBws"
getgenv().SetFpsCap = false
getgenv().FpsCap = 15
getgenv().OneClickUi = true
getgenv().FpsBoost1 = true
getgenv().WhiteScreen = true
getgenv().UiCheckItems = false
getgenv().OneClickSetting = {
    Enable = true,
    UnlimitGetQuest = true,
    TripleQuest = true,
    AutoAddStats = true,
    RedeemCode = true,
    Sea2KeyHop = false,
    FruitEat = {
        [1] = {"Magma-Magma"},
        [2] = {"Magma-Magma"}
    },
    EatFruitFromStorage = true,
    SnipeFruit = true,
    SnipeFruitMirage = true,
    HopIfFoundNearExploiter = false,
    HopHakiColor = false,
    HopTushita = false,
    HopValkyriehelm = false,
    HopMirrorFractal = false,
    FarmPole = false,
    FarmItems = false,
    DisableSoulGuitar = true,
    DisableCDK = false
}
getgenv().OneClickFarms = {["Shark Anchor"] = false}
getgenv().Team = "Pirates"
getgenv().AutoLoad = false

-- Tải script từ URL
local success, errorMessage = pcall(function()
    loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/3b2169cf53bc6104dabe8e19562e5cc2.lua"))()
end)

if not success then
    warn("Không thể tải script từ URL: " .. errorMessage)
end
